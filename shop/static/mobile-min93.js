function get(selector){var r = selector.match(/^#[a-zA-Z-_]+$/);if(r)return document.querySelector(r[0]);else{return null;}}function getAll(selector){if(selector.includes(',')){var items = [];for(var i of selector.split(',')){if(i.match(/^#[a-zA-Z-]+$/))var result = document.querySelector(i);else{var result = Array.prototype.slice.call(document.querySelectorAll(i));}if(Array.isArray(result)){for(j of result){items.push(j);}}else{items.push(result);}}return items;}else{return Array.prototype.slice.call(document.querySelectorAll(selector));}}var $ = function (selector) {if(selector.match(/^#[a-zA-Z-_]+$/)){var item = document.querySelector(selector.match(/^#[a-zA-Z-_]+$/)[0]);if(item)return item;else{return [];}}else{if(selector.includes(',')){var item = [];for(var i of selector.split(',')){if(i.match(/^#[a-zA-Z-]+$/))var result = document.querySelector(i);else{var result = Array.prototype.slice.call(document.querySelectorAll(i));}if(Array.isArray(result)){for(j of result){item.push(j);}}else{item.push(result);}}return item;}else{return Array.prototype.slice.call(document.querySelectorAll(selector));}}};HTMLCollection.prototype.toArray = function(array){if(!array)array = [];for(item of this){array.push(item);if(item.children.length)array = item.children.toArray(array);}return array;};Element.prototype.styles = function(property){return window.getComputedStyle($('#menu'))[property];};Element.prototype.includes = function(target){if(this.children.toArray().includes(target))return true;else{return false;}};String.prototype.title = function() {return this.charAt(0).toUpperCase() + this.slice(1);};create = function(element){return document.createElement(element);};log = function(log){console.log(log);};window.width = window.innerWidth;Element.prototype.grid = function(){this.style.display = 'grid';};Element.prototype.next = function(){return this.nextElementSibling;};Element.prototype.prev = function(){return this.previousElementSibling;};Element.prototype.last = function(){return this.lastElementChild;};Element.prototype.active = function(){if(this.className.includes('active')){this.removeClass('active');}else{this.addClass('active');}};Element.prototype.renameClass = function(name,replace){if(this.classList.contains(name)){this.classList.remove(name);this.classList.add(replace);}};Element.prototype.toggleMenu = function(parameters){var item = this;var timeout = setTimeout(function(){item.active();if(parameters.parent){if(parameters.parent.activeItem == item){parameters.parent.activeItem = undefined;return;}if(parameters.closeAll && parameters.parent.activeItem)parameters.parent.activeItem.active();parameters.parent.activeItem = item;}},parameters.timeout ? parameters.timeout : 0);};Element.prototype.parent = function(){return this.parentElement;};Element.prototype.find = function(selector){try{if(selector.includes('#') && (!selector.includes(' ') || selector.includes(','))){return this.querySelector(selector);}else{return Array.prototype.slice.call(this.querySelectorAll(selector));}}catch(e){log(e);}};Element.prototype.closer = function(selector){var result = undefined;var parent = this.parent();while(!result){result = parent.find(selector);if(!result || (Array.isArray(result) && !result.length))result = undefined;else if(Array.isArray(result) && result.length){return result[0];}parent = parent.parent();if(!parent)return undefined;}return result;};Element.prototype.replace = function(n,o){this.replaceChild(n,o);};Element.prototype.append = function(child){if(child){this.appendChild(child);}};Element.prototype.before = function(child,before){if(child){if(!before)before = this.childNodes[0];else{before = this.childNodes[before];}this.insertBefore(child,before);}};Element.prototype.getBefore = function(){return window.getComputedStyle(this, ':before');};Element.prototype.clear = function(){while(this.firstChild){this.removeChild(this.firstChild);}};Element.prototype.each = function(func){for(i=0;i<this.children.length;i++){func(this.children[i]);}};async function eachAsync(func,asyncFunc){this.forEach(item => {func(item);});await asyncFunc();};Element.prototype.eachAsync = eachAsync;Element.prototype.attr = function(name){return this.getAttribute(name);};Element.prototype.get = function(name){return this.getAttribute(name);};Element.prototype.set = function(name,value){return this.setAttribute(name,value);};Element.prototype.removeAttr = function(name){return this.removeAttribute(name);};Element.prototype.html = function(html){if(html)this.innerHTML = html;else{return this.innerHTML;}};Element.prototype.after = function(html){this.innerHTML += html;};Element.prototype.first = function(){return this.firstElementChild;};Element.prototype.show = function(type){if(type)this.style.display = type;else{this.style.display = 'block';}};Element.prototype.hide = function(){this.style.display = 'none';};Element.prototype.toggle = function(type){if(this.style.display == 'none' || this.style.display == ''){if(type)this.style.display = type;else{this.style.display = 'block';}}else{this.style.display = 'none';}};Element.prototype.addClass = function(name){this.classList.add(name);};Element.prototype.removeClass = function(name){this.classList.remove(name);};Element.prototype.hasClass = function(name){if(this.className.includes(name))return true;else{return false}};Element.prototype.toggleClass = function(name){if(this.hasClass(name))this.removeClass(name);else{this.addClass(name);}};Element.prototype.on = function(events,listener){events = events.split(' ');for(event in events){this.addEventListener(events[event],listener);}};Element.prototype.removeEvent = function(events,listener){events = events.split(' ');for(event in events){this.removeEventListener(events[event],listener);}};Element.prototype.switchClass = function(class1,class2){if(this.hasClass(class1)){this.removeClass(class1);this.addClass(class2);}else if(this.hasClass(class2)){this.removeClass(class2);this.addClass(class1);}};Array.prototype.switchClass = function(class1,class2){this.forEach(function(elem){if(elem.hasClass(class1)){elem.removeClass(class1);elem.addClass(class2);}else if(elem.hasClass(class2)){elem.removeClass(class2);elem.addClass(class1);}});};Array.prototype.each = function(func){for(i=0;i < this.length;i++){func(this[i]);}};Array.prototype.last = function(){return this[this.length - 1];};Array.prototype.toggle = function(type){this.forEach(function(elem){if(elem.style.display == 'none' || elem.style.display == ''){if(type)elem.style.display = type;else{elem.style.display = 'block';}}else{elem.style.display = 'none';}});};Array.prototype.next = function(){return this[0].nextElementSibling;};Array.prototype.on = function(event,listener,selector){events = event.split(' ');this.forEach(function(elem){if(elem){for(event in events){elem.addEventListener(events[event],listener);}}});};Array.prototype.removeEvent = function(event,listener,selector){events = event.split(' ');this.forEach(function(elem){for(event in events){elem.removeEventListener(events[event],listener);}});};Array.prototype.after = function(html){this.forEach(function(elem){elem.innerHTML += html;});};Array.prototype.toggleClass = function(name){this.forEach(function(elem){if(elem.hasClass(name))elem.removeClass(name);else{elem.addClass(name);}});};Array.prototype.show = function(type){if(type)this.forEach(function(elem){elem.style.display = type;});else{this.forEach(function(elem){elem.style.display = 'block';});}};Array.prototype.hide = function(){this.forEach(function(elem){elem.style.display = 'none';});};Array.prototype.clear = function(){this.forEach(function(elem){while(elem.firstChild){elem.removeChild(elem.firstChild);}});};Array.prototype.append = function(child){this.forEach(function(elem){elem.append(child)});};Array.prototype.active = function(){this.forEach(function(elem){if(elem.className.includes('active')){elem.removeClass('active');}else{elem.addClass('active');}});};Array.prototype.addClass = function(name){this.forEach(function(elem){elem.classList.add(name);});};Array.prototype.removeAttr = function(name){this.forEach(function(elem){elem.removeAttr(name);});};Array.prototype.removeClass = function(name){this.forEach(function(elem){if(elem.className.includes(name))elem.removeClass(name);});};Array.prototype.before = function(child,before){this.forEach(function(elem){if(!before)before = elem.childNodes[0];else{before = elem.childNodes[before];}elem.insertBefore(child,before)});};Array.prototype.hasClass = function(name){if(this[0].className.includes(name))return true;else{return false}};Array.prototype.html = function(html){if(html){this.forEach(function(elem){elem.innerHTML = html;});}else{return this[0].innerHTML;}};Array.prototype.set = function(name,value){this.forEach(function(elem){elem.setAttribute(name,value);});};Array.prototype.first = function(){this[0];};Array.prototype.css = function(attr,value){this.forEach(function(elem){if(value)elem.style[attr] = value;});};Array.prototype.text = function(text){if(text){this.forEach(function(elem){try{elem.firstChild.nodeValue = text;}catch(e){t = document.createTextNode(text);elem.append(t);}});}else{try{return this[0].firstChild.nodeValue;}catch(e){return undefined;}}};Array.prototype.width = function(){return this[0].clientWidth;};Array.prototype.height = function(){return this[0].clientHeight;};Element.prototype.height = function(){return this.clientHeight;};Element.prototype.text = function(text){if(text){try{this.firstChild.nodeValue = text;}catch(e){t = document.createTextNode(text);this.append(t);}}else{return this.innerText;}};Element.prototype.width = function(){return this.clientWidth;};Element.prototype.top = function(value){this.style['top'] = value;};Element.prototype.enable = function(){this.removeAttr('disabled');};Element.prototype.disable = function(){this.set('disabled','');};HTMLElement.prototype.css = function(attr,value){if(value)this.style[attr] = value;else{return this.style[attr];}};Element.prototype.triggerError = function(message){this.addClass('invalid');var errorBlock = this.next();if(!errorBlock.hasClass('errors')){errorBlock = $(`.${this.name}.errors`)[0];}if(errorBlock){errorBlock.html(message);errorBlock.show();}if(this.form)this.form.triggerInvalid();};Element.prototype.removeError = function(){this.removeClass('invalid');var errorBlock = this.next();if(!errorBlock.hasClass('errors')){errorBlock = $(`.${this.name}.errors`)[0];}if(errorBlock)errorBlock.hide();};HTMLFormElement.prototype.triggerInvalid = function(){this.addClass('invalid');if(this.validateSubmit){this.validateSubmit.addClass('disabled');this.validateSubmit.set('disabled','disabled');}};HTMLFormElement.prototype.triggerValid = function(){this.removeClass('invalid');if(this.validateSubmit){this.validateSubmit.removeClass('disabled');this.validateSubmit.removeAttr('disabled');}};Element.prototype.triggerInvalid = function(){this.addClass('invalid');if(this.validateSubmit){this.validateSubmit.addClass('disabled');this.validateSubmit.set('disabled','disabled');}};Element.prototype.triggerValid = function(){this.removeClass('invalid');if(this.validateSubmit){this.validateSubmit.removeClass('disabled');this.validateSubmit.removeAttr('disabled');}};Element.prototype.validate = function(rules){validator = new Validator(this,rules);};Array.prototype.ready = function(func){this.forEach(function(elem){elem.onload = func;});};Element.prototype.ready = function(func){this.onload = func;};Array.prototype.delete = function(val) {this.splice(this.indexOf(val),1);};Array.prototype.remove = function() {this.forEach(function(elem){elem.remove();});};function serialize(){var i, j, q = [];var data = new FormData();for (i = this.elements.length - 1; i >= 0; i = i - 1) {if (this.elements[i].name === "") {continue;}switch (this.elements[i].nodeName) {case 'INPUT':switch (this.elements[i].type) {case 'text':case 'hidden':case 'password':case 'button':case 'reset':case 'submit':case 'number':case 'date':if(this.elements[i].value)data.append(this.elements[i].name, this.elements[i].value);break;case 'checkbox':case 'radio':if (this.elements[i].checked) {data.append(this.elements[i].name, this.elements[i].value);}break;case 'file':file = this.elements[i].files[0];if(file){data.append(file.name, file);}break;}break; case 'TEXTAREA':if(this.elements[i].value)data.append(this.elements[i].name, this.elements[i].value);break;case 'SELECT':switch (this.elements[i].type) {case 'select-one':if(this.elements[i].value)data.append(this.elements[i].name, this.elements[i].value);break;case 'select-multiple':for (j = this.elements[i].options.length - 1; j >= 0; j = j - 1) {if (this.elements[i].options[j].selected) {data.append(this.elements[i].name, this.elements[i].options[j].value);}}break;}break;case 'BUTTON':switch (this.elements[i].type) {case 'reset':case 'submit':case 'button':data.append(this.elements[i].name, this.elements[i].value);break;}break;}}return data;}function serializeJSON(){var i, j, q = [];var data = {};var elements = this.elements;if(!this.elements)elements = this.find('*');for (i = elements.length - 1; i >= 0; i = i - 1) {if (elements[i].name === "") {continue;}switch (elements[i].nodeName) {case 'INPUT':switch (elements[i].type) {case 'text':case 'hidden':case 'password':case 'button':case 'reset':case 'submit':case 'number':case 'date':case 'email':case 'tel':if(elements[i].name.includes('[]') && elements[i].value){name = elements[i].name.replace('[]','');if(!data[name])data[name] = [];data[name].push(elements[i].value);}else if(elements[i].value)data[elements[i].name] = elements[i].value;break;case 'checkbox':case 'radio':if(elements[i].name.includes('[]') && elements[i].value && elements[i].checked){name = elements[i].name.replace('[]','');if(!data[name])data[name] = [];data[name].push(elements[i].value);}else if (elements[i].checked) {data[elements[i].name] = elements[i].value;}break;case 'file':if(elements[i].name == 'images'){if(!data['images'])data['images'] = [];data['images'].push(elements[i].get('value'));}else{data[elements[i].name] = elements[i].get('value');}break;}break; case 'TEXTAREA':if(elements[i].value)data[elements[i].name] = elements[i].value;break;case 'SELECT':switch (elements[i].type) {case 'select-one':if(elements[i].name.includes('[]') && elements[i].value){name = elements[i].name.replace('[]','');if(!data[name])data[name] = [];data[name].push(elements[i].value);}else if(elements[i].value)data[elements[i].name] = elements[i].value;break;case 'select-multiple':for (j = elements[i].options.length - 1; j >= 0; j = j - 1) {if (elements[i].options[j].selected) {data[elements[i].name] = elements[i].options[j].value;}}break;}break;case 'BUTTON':switch (elements[i].type) {case 'reset':case 'submit':case 'button':data[elements[i].name] = elements[i].value;break;}break;}}for(key in data){try{val = JSON.parse(data[key]);if(Array.isArray(val))data[key] = val;}catch(e){}}return data;}HTMLFormElement.prototype.serializeJSON = serializeJSON;HTMLFormElement.prototype.serialize = serialize;Array.prototype.serialize = function(){return this[0].serialize();};Array.prototype.serializeJSON = function(){return this[0].serializeJSON();};Element.prototype.serializeJSON = serializeJSON;cookie = function(){};cookie.toString = function(){return document.cookie;};cookie.get = function (cname) {name = cname + "=";decodedCookie = decodeURIComponent(cookie);ca = decodedCookie.split(';');for(i = 0; i <ca.length; i++) {c = ca[i];while (c.charAt(0) == ' ') {c = c.substring(1);}if (c.indexOf(name) == 0) {return c.substring(name.length, c.length);}}return "";};storage = localStorage;history = window.history;function render(template,block,data){var block = $(block);block.html(templates[template](data));}document.ready = function(listener){document.onreadystatechange = function(){if(document.readyState == 'complete')listener();};};function getTemplate(node){return node.content.cloneNode(true);}function getQueryParams(qs) {qs = qs.split('+').join(' ');var params = {},tokens,re = /[?&]?([^=]+)=([^&]*)/g;while (tokens = re.exec(qs)) {params[decodeURIComponent(tokens[1])] = decodeURIComponent(tokens[2]);}return params;}function getCookie(name) {let cookieValue = null;if (document.cookie && document.cookie !== '') {const cookies = document.cookie.split(';');for (let i = 0; i < cookies.length; i++) {const cookie = cookies[i].trim();if (cookie.substring(0, name.length + 1) === (name + '=')) {cookieValue = decodeURIComponent(cookie.substring(name.length + 1));break;}}}return cookieValue;}function scrollTop(){window.scroll({top:0,left:0,behavior: 'smooth'});}http = new XMLHttpRequest();body = $('body');loading = create('div');loading.hide();loading.set('id','loading');bg = create('div');bg.hide();bg.set('id','bg');body.append(bg);body.append(loading);http.loading = loading;http.bg = bg;http.progress = false;http.get = function (url) {this.method = 'GET';this.url = url;this.request();};http.post = function (url, data) {this.method = 'POST';this.url = url;this.data = data;this.request();};http.response = http.responseText;http.onreadystatechange = function () {switch (this.readyState) {case 4:this.loading.hide();this.progress = false;if (this.status == 200) {if (this.getResponseHeader('Content-Type') == 'application/json') {try {this.json = JSON.parse(this.responseText);} catch (e) {console.log(e);}}this.text = this.responseText;try {this.action();} catch (e) {log(e);/*this.render();*/}}else {this.alert(this.status);}break;}};http.request = function () {if (this.progress)return;this.loading.show();this.open(this.method, this.url);if (this.method == 'POST') {if (this.data instanceof FormData) {this.setRequestHeader("X-CSRFToken", cookie.get('csrftoken'));}else if (typeof this.data == 'object') {this.data = JSON.stringify(this.data);this.setRequestHeader("X-CSRFToken", cookie.get('csrftoken'));this.setRequestHeader("Content-Type", "application/json");}else {this.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');}}this.setRequestHeader('X-Requested-With', 'XMLHttpRequest');this.progress = true;this.send(this.data);};httpAlert = create('div');httpAlert.set('id', 'http-alert');message = create('div');message.set('id', 'message');close = create('div');close.set('class', 'close');httpAlert.append(close);httpAlert.append(message);body.append(httpAlert);timeout = false;http.alert = function (text, scnds) {if (!scnds)scnds = 3000;message.html(text);httpAlert.active();timeout = setTimeout(function () { httpAlert.active() }, scnds);};httpAlert.on('mouseover', function () {if (timeout)clearTimeout(timeout);});httpAlert.on('mouseout', function () {timeout = setTimeout(function () { httpAlert.hide() }, 3000);});close.on('click', function () {httpAlert.hide();});http.renderErrors = function () {text = '';errors = this.json.errors;for (error in errors) {text += `${error}: ${errors[error]}` + '<br> <br>';}this.alert(text, 10000)};function customizeSelect(parameters){var x, i, j, selElmnt, a, b, c;/* Look for any elements with the class "custom-select": */if(parameters && parameters.items)x = parameters.items;else{x = document.getElementsByClassName("custom-select");}for (i = 0; i < x.length; i++) {selElmnt = x[i].getElementsByTagName("select")[0];/* For each element, create a new DIV that will act as the selected item: */a = document.createElement("DIV");a.setAttribute("class", "select-selected");a.innerHTML = selElmnt.options[selElmnt.selectedIndex].innerHTML;x[i].appendChild(a);/* For each element, create a new DIV that will contain the option list: */b = document.createElement("DIV");b.setAttribute("class", "select-items");for (j = 0; j < selElmnt.length; j++) {/* For each option in the original select element,create a new DIV that will act as an option item: */c = document.createElement("DIV");c.innerHTML = selElmnt.options[j].innerHTML;if(selElmnt.options[j].selected)c.setAttribute("class", "same-as-selected");c.addEventListener("click", function(e) {/* When an item is clicked, update the original select box,and the selected item: */var y, i, k, s, h;s = this.parentNode.parentNode.getElementsByTagName("select")[0];h = this.parentNode.previousSibling;for (i = 0; i < s.length; i++) {if (s.options[i].innerHTML == this.innerHTML) {s.selectedIndex = i;h.innerHTML = this.innerHTML;y = this.parentNode.getElementsByClassName("same-as-selected");for (k = 0; k < y.length; k++) {y[k].removeAttribute("class");}this.setAttribute("class", "same-as-selected");break;}}s.dispatchEvent(new Event('change'));h.click();if(parameters && parameters.handler)parameters.handler();});b.appendChild(c);}x[i].appendChild(b);a.addEventListener("click", function(e) {/* When the select box is clicked, close any other select boxes,and open/close the current select box: */e.stopPropagation();closeAllSelect(this);this.nextElementSibling.classList.toggle('active');this.classList.toggle("select-arrow-active");});}function closeAllSelect(elmnt) {/* A function that will close all select boxes in the document,except the current select box: */var x, y, i, arrNo = [];x = document.getElementsByClassName("select-items");y = document.getElementsByClassName("select-selected");for (i = 0; i < y.length; i++) {if (elmnt == y[i]) {arrNo.push(i)} else {y[i].classList.remove("select-arrow-active");}}for (i = 0; i < x.length; i++) {if (arrNo.indexOf(i)) {x[i].classList.remove("active");}}}/* If the user clicks anywhere outside the select box,then close all select boxes: document.addEventListener("click", closeAllSelect);*/}/*! nouislider - 13.1.1 - 2/14/2019 */!function(t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():window.noUiSlider=t()}(function(){"use strict";var lt="13.1.1";function ut(t){t.parentElement.removeChild(t)}function s(t){return null!=t}function ct(t){t.preventDefault()}function i(t){return"number"==typeof t&&!isNaN(t)&&isFinite(t)}function pt(t,e,r){0<r&&(ht(t,e),setTimeout(function(){mt(t,e)},r))}function ft(t){return Math.max(Math.min(t,100),0)}function dt(t){return Array.isArray(t)?t:[t]}function e(t){var e=(t=String(t)).split(".");return 1<e.length?e[1].length:0}function ht(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function mt(t,e){t.classList?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")}function gt(t){var e=void 0!==window.pageXOffset,r="CSS1Compat"===(t.compatMode||"");return{x:e?window.pageXOffset:r?t.documentElement.scrollLeft:t.body.scrollLeft,y:e?window.pageYOffset:r?t.documentElement.scrollTop:t.body.scrollTop}}function c(t,e){return 100/(e-t)}function p(t,e){return 100*e/(t[1]-t[0])}function f(t,e){for(var r=1;t>=e[r];)r+=1;return r}function r(t,e,r){if(r>=t.slice(-1)[0])return 100;var n,i,o=f(r,t),a=t[o-1],s=t[o],l=e[o-1],u=e[o];return l+(i=r,p(n=[a,s],n[0]<0?i+Math.abs(n[0]):i-n[0])/c(l,u))}function n(t,e,r,n){if(100===n)return n;var i,o,a=f(n,t),s=t[a-1],l=t[a];return r?(l-s)/2<n-s?l:s:e[a-1]?t[a-1]+(i=n-t[a-1],o=e[a-1],Math.round(i/o)*o):n}function o(t,e,r){var n;if("number"==typeof e&&(e=[e]),!Array.isArray(e))throw new Error("noUiSlider ("+lt+"): 'range' contains invalid value.");if(!i(n="min"===t?0:"max"===t?100:parseFloat(t))||!i(e[0]))throw new Error("noUiSlider ("+lt+"): 'range' value isn't numeric.");r.xPct.push(n),r.xVal.push(e[0]),n?r.xSteps.push(!isNaN(e[1])&&e[1]):isNaN(e[1])||(r.xSteps[0]=e[1]),r.xHighestCompleteStep.push(0)}function a(t,e,r){if(e)if(r.xVal[t]!==r.xVal[t+1]){r.xSteps[t]=p([r.xVal[t],r.xVal[t+1]],e)/c(r.xPct[t],r.xPct[t+1]);var n=(r.xVal[t+1]-r.xVal[t])/r.xNumSteps[t],i=Math.ceil(Number(n.toFixed(3))-1),o=r.xVal[t]+r.xNumSteps[t]*i;r.xHighestCompleteStep[t]=o}else r.xSteps[t]=r.xHighestCompleteStep[t]=r.xVal[t]}function l(t,e,r){var n;this.xPct=[],this.xVal=[],this.xSteps=[r||!1],this.xNumSteps=[!1],this.xHighestCompleteStep=[],this.snap=e;var i=[];for(n in t)t.hasOwnProperty(n)&&i.push([t[n],n]);for(i.length&&"object"==typeof i[0][0]?i.sort(function(t,e){return t[0][0]-e[0][0]}):i.sort(function(t,e){return t[0]-e[0]}),n=0;n<i.length;n++)o(i[n][1],i[n][0],this);for(this.xNumSteps=this.xSteps.slice(0),n=0;n<this.xNumSteps.length;n++)a(n,this.xNumSteps[n],this)}l.prototype.getMargin=function(t){var e=this.xNumSteps[0];if(e&&t/e%1!=0)throw new Error("noUiSlider ("+lt+"): 'limit', 'margin' and 'padding' must be divisible by step.");return 2===this.xPct.length&&p(this.xVal,t)},l.prototype.toStepping=function(t){return t=r(this.xVal,this.xPct,t)},l.prototype.fromStepping=function(t){return function(t,e,r){if(100<=r)return t.slice(-1)[0];var n,i=f(r,e),o=t[i-1],a=t[i],s=e[i-1],l=e[i];return n=[o,a],(r-s)*c(s,l)*(n[1]-n[0])/100+n[0]}(this.xVal,this.xPct,t)},l.prototype.getStep=function(t){return t=n(this.xPct,this.xSteps,this.snap,t)},l.prototype.getDefaultStep=function(t,e,r){var n=f(t,this.xPct);return(100===t||e&&t===this.xPct[n-1])&&(n=Math.max(n-1,1)),(this.xVal[n]-this.xVal[n-1])/r},l.prototype.getNearbySteps=function(t){var e=f(t,this.xPct);return{stepBefore:{startValue:this.xVal[e-2],step:this.xNumSteps[e-2],highestStep:this.xHighestCompleteStep[e-2]},thisStep:{startValue:this.xVal[e-1],step:this.xNumSteps[e-1],highestStep:this.xHighestCompleteStep[e-1]},stepAfter:{startValue:this.xVal[e],step:this.xNumSteps[e],highestStep:this.xHighestCompleteStep[e]}}},l.prototype.countStepDecimals=function(){var t=this.xNumSteps.map(e);return Math.max.apply(null,t)},l.prototype.convert=function(t){return this.getStep(this.toStepping(t))};var u={to:function(t){return void 0!==t&&t.toFixed(2)},from:Number};function d(t){if("object"==typeof(e=t)&&"function"==typeof e.to&&"function"==typeof e.from)return!0;var e;throw new Error("noUiSlider ("+lt+"): 'format' requires 'to' and 'from' methods.")}function h(t,e){if(!i(e))throw new Error("noUiSlider ("+lt+"): 'step' is not numeric.");t.singleStep=e}function m(t,e){if("object"!=typeof e||Array.isArray(e))throw new Error("noUiSlider ("+lt+"): 'range' is not an object.");if(void 0===e.min||void 0===e.max)throw new Error("noUiSlider ("+lt+"): Missing 'min' or 'max' in 'range'.");if(e.min===e.max)throw new Error("noUiSlider ("+lt+"): 'range' 'min' and 'max' cannot be equal.");t.spectrum=new l(e,t.snap,t.singleStep)}function g(t,e){if(e=dt(e),!Array.isArray(e)||!e.length)throw new Error("noUiSlider ("+lt+"): 'start' option is incorrect.");t.handles=e.length,t.start=e}function v(t,e){if("boolean"!=typeof(t.snap=e))throw new Error("noUiSlider ("+lt+"): 'snap' option must be a boolean.")}function b(t,e){if("boolean"!=typeof(t.animate=e))throw new Error("noUiSlider ("+lt+"): 'animate' option must be a boolean.")}function S(t,e){if("number"!=typeof(t.animationDuration=e))throw new Error("noUiSlider ("+lt+"): 'animationDuration' option must be a number.")}function x(t,e){var r,n=[!1];if("lower"===e?e=[!0,!1]:"upper"===e&&(e=[!1,!0]),!0===e||!1===e){for(r=1;r<t.handles;r++)n.push(e);n.push(!1)}else{if(!Array.isArray(e)||!e.length||e.length!==t.handles+1)throw new Error("noUiSlider ("+lt+"): 'connect' option doesn't match handle count.");n=e}t.connect=n}function w(t,e){switch(e){case"horizontal":t.ort=0;break;case"vertical":t.ort=1;break;default:throw new Error("noUiSlider ("+lt+"): 'orientation' option is invalid.")}}function y(t,e){if(!i(e))throw new Error("noUiSlider ("+lt+"): 'margin' option must be numeric.");if(0!==e&&(t.margin=t.spectrum.getMargin(e),!t.margin))throw new Error("noUiSlider ("+lt+"): 'margin' option is only supported on linear sliders.")}function E(t,e){if(!i(e))throw new Error("noUiSlider ("+lt+"): 'limit' option must be numeric.");if(t.limit=t.spectrum.getMargin(e),!t.limit||t.handles<2)throw new Error("noUiSlider ("+lt+"): 'limit' option is only supported on linear sliders with 2 or more handles.")}function C(t,e){if(!i(e)&&!Array.isArray(e))throw new Error("noUiSlider ("+lt+"): 'padding' option must be numeric or array of exactly 2 numbers.");if(Array.isArray(e)&&2!==e.length&&!i(e[0])&&!i(e[1]))throw new Error("noUiSlider ("+lt+"): 'padding' option must be numeric or array of exactly 2 numbers.");if(0!==e){if(Array.isArray(e)||(e=[e,e]),!(t.padding=[t.spectrum.getMargin(e[0]),t.spectrum.getMargin(e[1])])===t.padding[0]||!1===t.padding[1])throw new Error("noUiSlider ("+lt+"): 'padding' option is only supported on linear sliders.");if(t.padding[0]<0||t.padding[1]<0)throw new Error("noUiSlider ("+lt+"): 'padding' option must be a positive number(s).");if(100<=t.padding[0]+t.padding[1])throw new Error("noUiSlider ("+lt+"): 'padding' option must not exceed 100% of the range.")}}function N(t,e){switch(e){case"ltr":t.dir=0;break;case"rtl":t.dir=1;break;default:throw new Error("noUiSlider ("+lt+"): 'direction' option was not recognized.")}}function U(t,e){if("string"!=typeof e)throw new Error("noUiSlider ("+lt+"): 'behaviour' must be a string containing options.");var r=0<=e.indexOf("tap"),n=0<=e.indexOf("drag"),i=0<=e.indexOf("fixed"),o=0<=e.indexOf("snap"),a=0<=e.indexOf("hover"),s=0<=e.indexOf("unconstrained");if(i){if(2!==t.handles)throw new Error("noUiSlider ("+lt+"): 'fixed' behaviour must be used with 2 handles");y(t,t.start[1]-t.start[0])}if(s&&(t.margin||t.limit))throw new Error("noUiSlider ("+lt+"): 'unconstrained' behaviour cannot be used with margin or limit");t.events={tap:r||o,drag:n,fixed:i,snap:o,hover:a,unconstrained:s}}function k(t,e){if(!1!==e)if(!0===e){t.tooltips=[];for(var r=0;r<t.handles;r++)t.tooltips.push(!0)}else{if(t.tooltips=dt(e),t.tooltips.length!==t.handles)throw new Error("noUiSlider ("+lt+"): must pass a formatter for all handles.");t.tooltips.forEach(function(t){if("boolean"!=typeof t&&("object"!=typeof t||"function"!=typeof t.to))throw new Error("noUiSlider ("+lt+"): 'tooltips' must be passed a formatter or 'false'.")})}}function P(t,e){d(t.ariaFormat=e)}function A(t,e){d(t.format=e)}function M(t,e){if("boolean"!=typeof(t.keyboardSupport=e))throw new Error("noUiSlider ("+lt+"): 'keyboardSupport' option must be a boolean.")}function V(t,e){t.documentElement=e}function O(t,e){if("string"!=typeof e&&!1!==e)throw new Error("noUiSlider ("+lt+"): 'cssPrefix' must be a string or `false`.");t.cssPrefix=e}function L(t,e){if("object"!=typeof e)throw new Error("noUiSlider ("+lt+"): 'cssClasses' must be an object.");if("string"==typeof t.cssPrefix)for(var r in t.cssClasses={},e)e.hasOwnProperty(r)&&(t.cssClasses[r]=t.cssPrefix+e[r]);else t.cssClasses=e}function vt(e){var r={margin:0,limit:0,padding:0,animate:!0,animationDuration:300,ariaFormat:u,format:u},n={step:{r:!1,t:h},start:{r:!0,t:g},connect:{r:!0,t:x},direction:{r:!0,t:N},snap:{r:!1,t:v},animate:{r:!1,t:b},animationDuration:{r:!1,t:S},range:{r:!0,t:m},orientation:{r:!1,t:w},margin:{r:!1,t:y},limit:{r:!1,t:E},padding:{r:!1,t:C},behaviour:{r:!0,t:U},ariaFormat:{r:!1,t:P},format:{r:!1,t:A},tooltips:{r:!1,t:k},keyboardSupport:{r:!0,t:M},documentElement:{r:!1,t:V},cssPrefix:{r:!0,t:O},cssClasses:{r:!0,t:L}},i={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",keyboardSupport:!0,cssPrefix:"noUi-",cssClasses:{target:"target",base:"base",origin:"origin",handle:"handle",handleLower:"handle-lower",handleUpper:"handle-upper",touchArea:"touch-area",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",connects:"connects",ltr:"ltr",rtl:"rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"}};e.format&&!e.ariaFormat&&(e.ariaFormat=e.format),Object.keys(n).forEach(function(t){if(!s(e[t])&&void 0===i[t]){if(n[t].r)throw new Error("noUiSlider ("+lt+"): '"+t+"' is required.");return!0}n[t].t(r,s(e[t])?e[t]:i[t])}),r.pips=e.pips;var t=document.createElement("div"),o=void 0!==t.style.msTransform,a=void 0!==t.style.transform;r.transformRule=a?"transform":o?"msTransform":"webkitTransform";return r.style=[["left","top"],["right","bottom"]][r.dir][r.ort],r}function z(t,f,o){var l,u,a,c,i,s,e,p,d=window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"},h=window.CSS&&CSS.supports&&CSS.supports("touch-action","none")&&function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,e)}catch(t){}return t}(),y=t,m=!0,E=f.spectrum,g=[],v=[],b=[],S=0,x={},w=t.ownerDocument,C=f.documentElement||w.documentElement,N=w.body,U=-1,k=0,P=1,A=2,M="rtl"===w.dir||1===f.ort?0:100;function V(t,e){var r=w.createElement("div");return e&&ht(r,e),t.appendChild(r),r}function O(t,e){var r=V(t,f.cssClasses.origin),n=V(r,f.cssClasses.handle);return V(n,f.cssClasses.touchArea),n.setAttribute("data-handle",e),f.keyboardSupport&&(n.setAttribute("tabindex","0"),n.addEventListener("keydown",function(t){return function(t,e){if(z(e))return!1;var r=["Left","Right"],n=["Down","Up"];f.dir&&!f.ort?r.reverse():f.ort&&!f.dir&&n.reverse();var i=t.key.replace("Arrow",""),o=i===n[0]||i===r[0],a=i===n[1]||i===r[1];if(!o&&!a)return!0;t.preventDefault();var s=o?0:1,l=st(e)[s];if(null===l)return!1;!1===l&&(l=E.getDefaultStep(v[e],o,10));return l=Math.max(l,1e-7),l*=o?-1:1,m=!1,ot(e,g[e]+l,!0),!(m=!0)}(t,e)})),n.setAttribute("role","slider"),n.setAttribute("aria-orientation",f.ort?"vertical":"horizontal"),0===e?ht(n,f.cssClasses.handleLower):e===f.handles-1&&ht(n,f.cssClasses.handleUpper),r}function L(t,e){return!!e&&V(t,f.cssClasses.connect)}function r(t,e){return!!f.tooltips[e]&&V(t.firstChild,f.cssClasses.tooltip)}function z(t){return u[t].hasAttribute("disabled")}function j(){i&&(G("update.tooltips"),i.forEach(function(t){t&&ut(t)}),i=null)}function H(){j(),i=u.map(r),$("update.tooltips",function(t,e,r){if(i[e]){var n=t[e];!0!==f.tooltips[e]&&(n=f.tooltips[e].to(r[e])),i[e].innerHTML=n}})}function F(e,i,o){var a=w.createElement("div"),s=[];s[k]=f.cssClasses.valueNormal,s[P]=f.cssClasses.valueLarge,s[A]=f.cssClasses.valueSub;var l=[];l[k]=f.cssClasses.markerNormal,l[P]=f.cssClasses.markerLarge,l[A]=f.cssClasses.markerSub;var u=[f.cssClasses.valueHorizontal,f.cssClasses.valueVertical],c=[f.cssClasses.markerHorizontal,f.cssClasses.markerVertical];function p(t,e){var r=e===f.cssClasses.value,n=r?s:l;return e+" "+(r?u:c)[f.ort]+" "+n[t]}return ht(a,f.cssClasses.pips),ht(a,0===f.ort?f.cssClasses.pipsHorizontal:f.cssClasses.pipsVertical),Object.keys(e).forEach(function(t){!function(t,e,r){if((r=i?i(e,r):r)!==U){var n=V(a,!1);n.className=p(r,f.cssClasses.marker),n.style[f.style]=t+"%",k<r&&((n=V(a,!1)).className=p(r,f.cssClasses.value),n.setAttribute("data-value",e),n.style[f.style]=t+"%",n.innerHTML=o.to(e))}}(t,e[t][0],e[t][1])}),a}function D(){c&&(ut(c),c=null)}function T(t){D();var m,g,v,b,e,r,S,x,w,n=t.mode,i=t.density||1,o=t.filter||!1,a=function(t,e,r){if("range"===t||"steps"===t)return E.xVal;if("count"===t){if(e<2)throw new Error("noUiSlider ("+lt+"): 'values' (>= 2) required for mode 'count'.");var n=e-1,i=100/n;for(e=[];n--;)e[n]=n*i;e.push(100),t="positions"}return"positions"===t?e.map(function(t){return E.fromStepping(r?E.getStep(t):t)}):"values"===t?r?e.map(function(t){return E.fromStepping(E.getStep(E.toStepping(t)))}):e:void 0}(n,t.values||!1,t.stepped||!1),s=(m=i,g=n,v=a,b={},e=E.xVal[0],r=E.xVal[E.xVal.length-1],x=S=!1,w=0,(v=v.slice().sort(function(t,e){return t-e}).filter(function(t){return!this[t]&&(this[t]=!0)},{}))[0]!==e&&(v.unshift(e),S=!0),v[v.length-1]!==r&&(v.push(r),x=!0),v.forEach(function(t,e){var r,n,i,o,a,s,l,u,c,p,f=t,d=v[e+1],h="steps"===g;if(h&&(r=E.xNumSteps[e]),r||(r=d-f),!1!==f&&void 0!==d)for(r=Math.max(r,1e-7),n=f;n<=d;n=(n+r).toFixed(7)/1){for(u=(a=(o=E.toStepping(n))-w)/m,p=a/(c=Math.round(u)),i=1;i<=c;i+=1)b[(s=w+i*p).toFixed(5)]=[E.fromStepping(s),0];l=-1<v.indexOf(n)?P:h?A:k,!e&&S&&(l=0),n===d&&x||(b[o.toFixed(5)]=[n,l]),w=o}}),b),l=t.format||{to:Math.round};return c=y.appendChild(F(s,o,l))}function R(){var t=l.getBoundingClientRect(),e="offset"+["Width","Height"][f.ort];return 0===f.ort?t.width||l[e]:t.height||l[e]}function q(n,i,o,a){var e=function(t){return!!(t=function(t,e,r){var n,i,o=0===t.type.indexOf("touch"),a=0===t.type.indexOf("mouse"),s=0===t.type.indexOf("pointer");0===t.type.indexOf("MSPointer")&&(s=!0);if(o){var l=function(t){return t.target===r||r.contains(t.target)};if("touchstart"===t.type){var u=Array.prototype.filter.call(t.touches,l);if(1<u.length)return!1;n=u[0].pageX,i=u[0].pageY}else{var c=Array.prototype.find.call(t.changedTouches,l);if(!c)return!1;n=c.pageX,i=c.pageY}}e=e||gt(w),(a||s)&&(n=t.clientX+e.x,i=t.clientY+e.y);return t.pageOffset=e,t.points=[n,i],t.cursor=a||s,t}(t,a.pageOffset,a.target||i))&&(!(y.hasAttribute("disabled")&&!a.doNotReject)&&(e=y,r=f.cssClasses.tap,!((e.classList?e.classList.contains(r):new RegExp("\\b"+r+"\\b").test(e.className))&&!a.doNotReject)&&(!(n===d.start&&void 0!==t.buttons&&1<t.buttons)&&((!a.hover||!t.buttons)&&(h||t.preventDefault(),t.calcPoint=t.points[f.ort],void o(t,a))))));var e,r},r=[];return n.split(" ").forEach(function(t){i.addEventListener(t,e,!!h&&{passive:!0}),r.push([t,e])}),r}function B(t){var e,r,n,i,o,a,s=100*(t-(e=l,r=f.ort,n=e.getBoundingClientRect(),i=e.ownerDocument,o=i.documentElement,a=gt(i),/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(a.x=0),r?n.top+a.y-o.clientTop:n.left+a.x-o.clientLeft))/R();return s=ft(s),f.dir?100-s:s}function X(t,e){"mouseout"===t.type&&"HTML"===t.target.nodeName&&null===t.relatedTarget&&_(t,e)}function Y(t,e){if(-1===navigator.appVersion.indexOf("MSIE 9")&&0===t.buttons&&0!==e.buttonsProperty)return _(t,e);var r=(f.dir?-1:1)*(t.calcPoint-e.startCalcPoint);Z(0<r,100*r/e.baseSize,e.locations,e.handleNumbers)}function _(t,e){e.handle&&(mt(e.handle,f.cssClasses.active),S-=1),e.listeners.forEach(function(t){C.removeEventListener(t[0],t[1])}),0===S&&(mt(y,f.cssClasses.drag),et(),t.cursor&&(N.style.cursor="",N.removeEventListener("selectstart",ct))),e.handleNumbers.forEach(function(t){J("change",t),J("set",t),J("end",t)})}function I(t,e){if(e.handleNumbers.some(z))return!1;var r;1===e.handleNumbers.length&&(r=u[e.handleNumbers[0]].children[0],S+=1,ht(r,f.cssClasses.active));t.stopPropagation();var n=[],i=q(d.move,C,Y,{target:t.target,handle:r,listeners:n,startCalcPoint:t.calcPoint,baseSize:R(),pageOffset:t.pageOffset,handleNumbers:e.handleNumbers,buttonsProperty:t.buttons,locations:v.slice()}),o=q(d.end,C,_,{target:t.target,handle:r,listeners:n,doNotReject:!0,handleNumbers:e.handleNumbers}),a=q("mouseout",C,X,{target:t.target,handle:r,listeners:n,doNotReject:!0,handleNumbers:e.handleNumbers});n.push.apply(n,i.concat(o,a)),t.cursor&&(N.style.cursor=getComputedStyle(t.target).cursor,1<u.length&&ht(y,f.cssClasses.drag),N.addEventListener("selectstart",ct,!1)),e.handleNumbers.forEach(function(t){J("start",t)})}function n(t){t.stopPropagation();var n,i,o,e=B(t.calcPoint),r=(n=e,o=!(i=100),u.forEach(function(t,e){if(!z(e)){var r=Math.abs(v[e]-n);(r<i||100===r&&100===i)&&(o=e,i=r)}}),o);if(!1===r)return!1;f.events.snap||pt(y,f.cssClasses.tap,f.animationDuration),rt(r,e,!0,!0),et(),J("slide",r,!0),J("update",r,!0),J("change",r,!0),J("set",r,!0),f.events.snap&&I(t,{handleNumbers:[r]})}function W(t){var e=B(t.calcPoint),r=E.getStep(e),n=E.fromStepping(r);Object.keys(x).forEach(function(t){"hover"===t.split(".")[0]&&x[t].forEach(function(t){t.call(s,n)})})}function $(t,e){x[t]=x[t]||[],x[t].push(e),"update"===t.split(".")[0]&&u.forEach(function(t,e){J("update",e)})}function G(t){var n=t&&t.split(".")[0],i=n&&t.substring(n.length);Object.keys(x).forEach(function(t){var e=t.split(".")[0],r=t.substring(e.length);n&&n!==e||i&&i!==r||delete x[t]})}function J(r,n,i){Object.keys(x).forEach(function(t){var e=t.split(".")[0];r===e&&x[t].forEach(function(t){t.call(s,g.map(f.format.to),n,g.slice(),i||!1,v.slice())})})}function K(t,e,r,n,i,o){return 1<u.length&&!f.events.unconstrained&&(n&&0<e&&(r=Math.max(r,t[e-1]+f.margin)),i&&e<u.length-1&&(r=Math.min(r,t[e+1]-f.margin))),1<u.length&&f.limit&&(n&&0<e&&(r=Math.min(r,t[e-1]+f.limit)),i&&e<u.length-1&&(r=Math.max(r,t[e+1]-f.limit))),f.padding&&(0===e&&(r=Math.max(r,f.padding[0])),e===u.length-1&&(r=Math.min(r,100-f.padding[1]))),!((r=ft(r=E.getStep(r)))===t[e]&&!o)&&r}function Q(t,e){var r=f.ort;return(r?e:t)+", "+(r?t:e)}function Z(t,n,r,e){var i=r.slice(),o=[!t,t],a=[t,!t];e=e.slice(),t&&e.reverse(),1<e.length?e.forEach(function(t,e){var r=K(i,t,i[t]+n,o[e],a[e],!1);!1===r?n=0:(n=r-i[t],i[t]=r)}):o=a=[!0];var s=!1;e.forEach(function(t,e){s=rt(t,r[t]+n,o[e],a[e])||s}),s&&e.forEach(function(t){J("update",t),J("slide",t)})}function tt(t,e){return f.dir?100-t-e:t}function et(){b.forEach(function(t){var e=50<v[t]?-1:1,r=3+(u.length+e*t);u[t].style.zIndex=r})}function rt(t,e,r,n){return!1!==(e=K(v,t,e,r,n,!1))&&(function(t,e){v[t]=e,g[t]=E.fromStepping(e);var r="translate("+Q(tt(e,0)-M+"%","0")+")";u[t].style[f.transformRule]=r,nt(t),nt(t+1)}(t,e),!0)}function nt(t){if(a[t]){var e=0,r=100;0!==t&&(e=v[t-1]),t!==a.length-1&&(r=v[t]);var n=r-e,i="translate("+Q(tt(e,n)+"%","0")+")",o="scale("+Q(n/100,"1")+")";a[t].style[f.transformRule]=i+" "+o}}function it(t,e){var n=dt(t),r=void 0===v[0];e=void 0===e||!!e,f.animate&&!r&&m&&pt(y,f.cssClasses.tap,f.animationDuration),b.forEach(function(t){var e,r;rt(t,(e=n[t],r=t,null===e||!1===e||void 0===e?v[r]:("number"==typeof e&&(e=String(e)),e=f.format.from(e),!1===(e=E.toStepping(e))||isNaN(e)?v[r]:e)),!0,!1)}),b.forEach(function(t){rt(t,v[t],!0,!0)}),et(),b.forEach(function(t){J("update",t),null!==n[t]&&e&&J("set",t)})}function ot(t,e,r){var n=[];if(!(0<=(t=Number(t))&&t<b.length))throw new Error("noUiSlider ("+lt+"): invalid handle number, got: "+t);for(var i=0;i<b.length;i++)n[i]=null;n[t]=e,it(n,r)}function at(){var t=g.map(f.format.to);return 1===t.length?t[0]:t}function st(t){var e=v[t],r=E.getNearbySteps(e),n=g[t],i=r.thisStep.step,o=null;!1!==i&&n+i>r.stepAfter.startValue&&(i=r.stepAfter.startValue-n),o=n>r.thisStep.startValue?r.thisStep.step:!1!==r.stepBefore.step&&n-r.stepBefore.highestStep,100===e?i=null:0===e&&(o=null);var a=E.countStepDecimals();return null!==i&&!1!==i&&(i=Number(i.toFixed(a))),null!==o&&!1!==o&&(o=Number(o.toFixed(a))),[o,i]}return ht(e=y,f.cssClasses.target),0===f.dir?ht(e,f.cssClasses.ltr):ht(e,f.cssClasses.rtl),0===f.ort?ht(e,f.cssClasses.horizontal):ht(e,f.cssClasses.vertical),l=V(e,f.cssClasses.base),function(t,e){var r=V(e,f.cssClasses.connects);u=[],(a=[]).push(L(r,t[0]));for(var n=0;n<f.handles;n++)u.push(O(e,n)),b[n]=n,a.push(L(r,t[n+1]))}(f.connect,l),(p=f.events).fixed||u.forEach(function(t,e){q(d.start,t.children[0],I,{handleNumbers:[e]})}),p.tap&&q(d.start,l,n,{}),p.hover&&q(d.move,l,W,{hover:!0}),p.drag&&a.forEach(function(t,e){if(!1!==t&&0!==e&&e!==a.length-1){var r=u[e-1],n=u[e],i=[t];ht(t,f.cssClasses.draggable),p.fixed&&(i.push(r.children[0]),i.push(n.children[0])),i.forEach(function(t){q(d.start,t,I,{handles:[r,n],handleNumbers:[e-1,e]})})}}),it(f.start),f.pips&&T(f.pips),f.tooltips&&H(),$("update",function(t,e,a,r,s){b.forEach(function(t){var e=u[t],r=K(v,t,0,!0,!0,!0),n=K(v,t,100,!0,!0,!0),i=s[t],o=f.ariaFormat.to(a[t]);r=E.fromStepping(r).toFixed(1),n=E.fromStepping(n).toFixed(1),i=E.fromStepping(i).toFixed(1),e.children[0].setAttribute("aria-valuemin",r),e.children[0].setAttribute("aria-valuemax",n),e.children[0].setAttribute("aria-valuenow",i),e.children[0].setAttribute("aria-valuetext",o)})}),s={destroy:function(){for(var t in f.cssClasses)f.cssClasses.hasOwnProperty(t)&&mt(y,f.cssClasses[t]);for(;y.firstChild;)y.removeChild(y.firstChild);delete y.noUiSlider},steps:function(){return b.map(st)},on:$,off:G,get:at,set:it,setHandle:ot,reset:function(t){it(f.start,t)},__moveHandles:function(t,e,r){Z(t,e,v,r)},options:o,updateOptions:function(e,t){var r=at(),n=["margin","limit","padding","range","animate","snap","step","format","pips","tooltips"];n.forEach(function(t){void 0!==e[t]&&(o[t]=e[t])});var i=vt(o);n.forEach(function(t){void 0!==e[t]&&(f[t]=i[t])}),E=i.spectrum,f.margin=i.margin,f.limit=i.limit,f.padding=i.padding,f.pips?T(f.pips):D(),f.tooltips?H():j(),v=[],it(e.start||r,t)},target:y,removePips:D,removeTooltips:j,pips:T}}return{__spectrum:l,version:lt,create:function(t,e){if(!t||!t.nodeName)throw new Error("noUiSlider ("+lt+"): create requires a single element, got: "+t);if(t.noUiSlider)throw new Error("noUiSlider ("+lt+"): Slider was already initialized.");var r=z(t,vt(e),e);return t.noUiSlider=r}}});class Validator{constructor(form,rules){this.valid = [];this.invalid = [];this.form = form;this.rules = rules;this.form.validateSubmit = this.form.find('#submit');this.form.valid = false;if(this.form.validateSubmit)this.form.on('submit',this.submit.bind(this));for(let[key,rulesList] of Object.entries(rules)){this.listenRules(this.form.find(`[name=${key}]`)[0],rulesList);}}listenRules(elem,rule){elem.on(rule['event'] ? rule['event'] : 'paste keydown focusout',function(event){var elem = event.target;if(elem.timeout)clearTimeout(elem.timeout);if(event.type == 'focusout'){if(!elem.value && rule['required'])this.error(elem,rule['errors']['required']);else if(elem.invalid){return false;}}elem.removeError();elem.invalid = false;if(!event.metaKey && event.keyCode != 8 && event.keyCode != 9){if(rule['rules']['max_length'] && elem.value.length >= rule['rules']['max_length']){if(elem.selectionEnd == elem.selectionStart){event.stopPropagation();event.preventDefault();return false;}}if(event.key && rule['rules']['allow_symbols'] && !event.key.match(rule['rules']['allow_symbols'])){event.stopPropagation();event.preventDefault();return false;}}var that = this;elem.timeout = setTimeout(function(){if(!elem.value && !rule.required)return;that.cleanWhiteSpaces(elem);that.validate(elem,rule);if(!elem.invalid && rule['unique'])that.unique(elem,rule['errors']['unique']);},rule['timeout'] ? rule['timeout'] : 1500);event.stopPropagation();return false;}.bind(this));}submit(event){for(let[key,rule] of Object.entries(this.rules)){var elem = this.form.find(`[name=${key}]`)[0];this.validate(elem,rule);if(!elem.invalid && rule['unique'])this.unique(elem,rule['errors']['unique']);}if(!Array.isArray($("#g-recaptcha-response")) && !$("#g-recaptcha-response").value){event.preventDefault();event.stopPropagation();return false;}if(this.invalid.length){this.invalid[0].focus();event.preventDefault();event.stopPropagation();return false;}}validate(elem,rules){for(let[key,rule] of Object.entries(rules['rules'])){var result = this[key](elem,rule);if(result){this.pop(elem);if(rules['handler'])rules.handler(elem);if(!this.invalid.length)this.form.triggerValid();}else{this.error(elem,rules['errors'][key]);}}}allow_symbols(){return true;}is_valid(){for(let[key,rule] of Object.entries(this.rules)){var elem = this.form.find(`[name=${key}]`)[0];this.validate(elem,rule);}if(this.invalid.length){this.invalid[0].focus();return false;}else{return true;}}cleanWhiteSpaces(elem){elem.value = elem.value.replace(/(^\s+|\s+$)/g, '');}checked(elem,rule){if(!elem.checked)return false;return true;}radio(elem,rule){if(!$(`[name="${elem.name}"]:checked`)[0])return false;return true;}equal(elem,rule){if(elem.value != this.form.find(`[name=${rule}]`)[0].value)return false;return true;}min_length(elem,rule){if(elem.value.length < rule)return false;return true;}max_length(elem,rule){if(elem.value.length > rule)return false;return true;}min(elem,rule){if(elem.value < rule)return false;return true;}max(elem,rule){if(elem.value > rule)return false;return true;}regex(elem,rule){var match = elem.value.match(rule);if(!match)return false;return true;}unique(elem,error){http.action = function(){if(http.json && !http.json.result){this.error(elem,error);if(!this.invalid.length)this.form.triggerValid();}};http.post('/match/user',{phone:elem.value});}push(elem){if(!this.invalid.includes(elem))this.invalid.push(elem);if(this.valid.includes(elem))this.valid.pop(elem);elem.invalid = true;}pop(elem){if(!this.valid.includes(elem))this.valid.push(elem);if(this.invalid.includes(elem))this.invalid.pop(elem);elem.invalid = false;}error(elem,error){elem.triggerError(error);this.push(elem);}}class Page{constructor(){this.navigation = null;this.searchQuery = '';this.progress = false;this.timeout = false;this.user = new User();this.cartQty = $('.cart .items_qty');this.menuBlock = $('#menu');this.mainBlock = $('#main');this.searchWidget = $('#search');this.navContainer = $('#navigation .head')[0];this.addCart = $('#add-cart');this.addCartText = $('#add-cart span.name')[0];this.favoriteButton = $('header .profile.favorite');this.compareButton = $('header .profile.compare');$('.categories-button').on('click',this.openCategories.bind(this));try{JSON.parse(storage.cart);}catch(e){this.clearCart();}if(!storage.qty || storage.qty == 'NaN')storage.qty = Object.keys(cart).length;this.cartQty.text(storage.qty);if(storage.qty && storage.qty != 0)$('#panel .cart').show();this.cart = JSON.parse(storage.cart);$('#menu-button').on('click',this.menu.bind(this));$('#searchButton').on('click',this.searchButton.bind(this));$("#scroll-up").on('click',function(){scrollTop();});$('main .noselect').on('contextmenu',function(){return false;});$('#phonesButton').on('click',this.phones);$('#search input[type=text]').on('input paste keypress',this.search.bind(this));$('#search #query').on('focus click',this.searchfocus.bind(this));$('.autocomplete').on('scroll click',function(event){event.stopPropagation();});$('#bg').on('click',this.hideBg.bind(this));$('.cart').on('click',this.openCart.bind(this));var href = new URL(location.href);if(href.searchParams)var q = href.searchParams.get('q');else{var query = getQueryParams(location.search);var q = query.q;}$('body').on('click',function(){if($('.autocomplete').css('display') == 'block'){$('.autocomplete').hide();}});addEventListener('scroll',function () {if(window.scrollY > 150){$("#scroll-up").show();}else{$("#scroll-up").hide();}});if(!storage.compare)storage.compare = '[]';this.compare = JSON.parse(storage.compare);try{$('header .fa-balance-scale')[0].prev().text(this.compare.length);}catch(e){}if(!storage.favorite)storage.favorite = '[]';this.favorite = JSON.parse(storage.favorite);try{$('header .fa-star')[0].prev().text(this.favorite.length);}catch(e){}if(this.favorite && this.favorite.length){this.favoriteButton.show();}if(this.compare && this.compare.length){this.compareButton.show();}}openCategories(){if(!this.navigation){Navigation.toggle();if(this.navigtation && !this.navigation.active)this.navigation = new Navigation();}if($('#navigation .head').length && $('#navigation .head')[0].offsetTop > 0)window.scrollTo({top:$('#navigation .head')[0].offsetTop - 56,behavior: 'smooth'});$('#menu').removeClass('active');$('#main').removeClass('active');}searchButton(){this.searchWidget.active();}menu(){this.menuBlock.active();this.mainBlock.active();}phones(){$('header .phones').active();}clearCart(){storage.cart = "{}";storage.qty = 0;this.cartQty.text('0');this.cart = {};}hideBg(event){var target = event.target;target.hide();$('#form').hide();}hideMessage(){if(this.addCart.hasClass('active'))this.addCart.active();if(this.messageTimeout)clearTimeout(this.messageTimeout)}message(text){if(this.addCart && this.addCartText){this.addCartText.text(text);if(!this.addCart.hasClass('active')){this.addCart.active();var that = this;if(this.messageTimeout)clearTimeout(this.messageTimeout);this.messageTimeout = setTimeout(function(){that.addCart.active();},7000);}}}renderForm(){$('#form').html(http.response);$('#form').addClass('show');$('#form .close').addClass('show');$('#bg').show();$('#form .close').on('click',function(){$('#form').removeClass('show');$('#bg').hide();this.removeClass('show');});}openCart(){var that = this;http.action = function(){that.renderForm();that.cartObject = new Cart();that.hideMessage();};var data = JSON.parse(storage.cart);data['csrfmiddlewaretoken'] = csrf_token;http.post(language +'/cart/',data);}autocomplete(query){if(query != this.searchQuery){this.searchQuery = query;http.action = function(){$('.autocomplete').html(http.responseText);$('.autocomplete').show();};http.get(`${language}/search?q=${this.searchQuery}&autocomplete=1`);}return false;}searchfocus(event){var that = this;if(this.searchQuery && this.searchQuery.length > 2){if($('.autocomplete').children.length == 0){http.action = function(){$('.autocomplete').html(http.responseText);};http.get(`/search?q=${this.searchQuery}&autocomplete=1`);}$('.autocomplete').show();}event.stopPropagation();return false;}search(event){var that = this;if(this.timeout)clearTimeout(this.timeout);this.timeout = setTimeout(function(){var query = $('#search input[type=text]')[0].value;if(query.length > 2){that.autocomplete(query);}},500)}}class Default{constructor(){}}class Cart{constructor(){$('#cart-form .quantity .minus').on('click',this.minus.bind(this));$('#cart-form .quantity .plus').on('click',this.plus.bind(this));$('#cart-form .quantity input').on('change',this.input.bind(this));$('#continue').on('click',this.continue.bind(this));$('#clear').on('click',this.clear.bind(this));$('#cart-form .remove').on('click',this.remove.bind(this));this.form = $('#cart-form');$('.checkoutButton').on('click',this.checkout.bind(this));}checkout(e){$('.checkoutButton').active();$('.checkoutButton .loading').active();http.action = function(){if(http.json && http.json.result){location.href = language + '/checkout/';}$('.checkoutButton').active();$('.checkoutButton .loading').active();};var data = $('form.cart')[0].serializeJSON();http.post(language + '/checkout/',data);}input(event){var target = event.target;var qty = target.value;var price = target.get('data-price');if(qty < 1 || isNaN(qty)){qty = 1;target.value = 1;}target.parent().parent().find('.total span').text(qty * price);this.total();}minus(event){var target = event.target;var input = target.next();var qty = input.value * 1 - 1;var productId = input.get('name');var price = input.get('data-price');if(qty > 0){input.set('value',qty);input.value = qty;cart[productId] = qty;storage.cart = JSON.stringify(cart);target.parent().parent().find('.total span').text((qty) * (price * 1));this.total();}return false;}plus(event){var target = event.target;var input = target.prev();var qty = input.value * 1 + 1;var productId = input.get('name');var price = input.get('data-price');if(qty > 1){input.value = qty;cart[productId] = qty;storage.cart = JSON.stringify(cart);target.parent().parent().find('.total span').text((qty) * (price * 1));this.total();}}remove(event){var remove = event.target;var that = this;http.action = function(){if(http.json && http.json.result){delete pageObject.cart[remove.get('product-id')];storage.cart = JSON.stringify(pageObject.cart);if(storage.qty > 0){storage.qty = parseInt(storage.qty) - 1;pageObject.cartQty.text(storage.qty);}remove.parent().remove();if(!storage.qty || storage.qty == 0)that.clear(event);that.total();}};http.get(`/cart/remove/${remove.get('item-id')}/`);}clear(event){var that = this;http.action = function(){pageObject.renderForm();pageObject.clearCart();};http.get('/cart/clear/');event.stopPropagation();event.preventDefault();return false;}continue(event){$('#form').hide();$('#bg').hide();event.stopPropagation();event.preventDefault();return false;}total(){var summa = 0;$("#cart-form .productItem .total").each(function(elem){summa = summa + (elem.find('span').text() * 1);});$('#cart-form #sum').text(summa);}}class Buy{constructor(){this.timeout = NaN;this.cartButton = $('#cart-button');this.toTarget = $('#cart-button');$('.buy').on('click touch',this.buy.bind(this));$('.quantity .minus').on('click touch',this.minus.bind(this));$('.quantity .plus').on('click touch',this.plus.bind(this));$('.quantity input').on('change',this.input.bind(this));}input(event){var target = event.target;var qty = target.value;if(qty < 1 || isNaN(qty)){qty = 1;target.value = 1;}}minus(event){var target = event.target;var input = target.next();var qty = input.value * 1 - 1;if(qty > 0){input.value = qty;}return false;}plus(event){var target = event.target;var input = target.prev();var qty = input.value * 1 + 1;if(qty > 1){input.value = qty;}}buy(event){var target = event.target;var parent = target.parent();var qty = target.closer('input[name="quantity"]');var id = target.get('value');if(!storage.qty || storage.qty == 'NaN')storage.qty = Object.keys(cart).length;if(!qty){var qty = 1;}else{var qty = qty.value ? qty.value : 1;}if(!pageObject.cart[id]){pageObject.cart[id] = qty;storage.qty++; pageObject.cartQty.text(storage.qty);}else{pageObject.cart[id] = parseInt(pageObject.cart[id]) + qty * 1;}pageObject.message(`${target.closer('.name').text()} ${qty}шт.`);storage.cart = JSON.stringify(pageObject.cart);this.animate(this.getDataToAnimate(target));}getDataToAnimate(target){var img = target.closer('img');var item = target.parent().getBoundingClientRect();var toTarget = this.toTarget;return [img,item,toTarget]}animate(data){var that = this;var img = data[0];var item = data[1];var toTarget = data[2];var toTargetData = toTarget.getBoundingClientRect();var i = create('img');i.set('src',img.src);i.css('left',`${item['x']}px`);i.css('top',`${item['y']}px`);i.css('z-index','9999');i.set('class','animateBuy');body[0].append(i);setTimeout(function(){i.css('left',`${toTargetData['x']}px`);i.css('top',`${toTargetData['y']}px`);i.css('height',`20px`);i.css('width',`20px`);setTimeout(function(){i.remove();toTarget.active();setTimeout(function(){toTarget.active();},300);},700);},300);}}class Rating{constructor(){this.value = parseInt($('#rating').value);this.stars = $('#ratingStars i');this.fill(this.value);this.stars.on('mouseover',this.hover.bind(this));this.stars.on('mouseout',this.out.bind(this));this.stars.on('click',this.click.bind(this));}click(event){var target = event.target;var number = target.get('number');this.value = number;event.stopPropagation();event.preventDefault();return false;}hover(event){var target = event.target;this.empty();this.fill(this.stars.indexOf(target) + 1);event.stopPropagation();event.preventDefault();return false;}out(event){this.empty();this.fill(this.value);event.stopPropagation();event.preventDefault();return false;}fill(value){var i = 0;while(i < value){this.stars[i].renameClass('far','fa');i++;}}empty(){this.stars.each(function(elem){elem.renameClass('fa','far');});}}class Gallery{constructor(gallery){this.gallery = gallery;$('#bg').on('click',this.close.bind(this));$('#big-photo, .gallery a').on('click',this.open.bind(this));}open(event){this.current = event.target.get('data-image');this.counter = this.gallery.indexOf(this.current);var template = getTemplate($('#galleryTemplate'));$('body').append(template);this.container = $('#gallery');this.containerImage = $('#gallery img');this.container.find('.close').on('click',this.close.bind(this));for(var src of gallery){var img = create('img');img.src = src;this.container.append(img);}$('#bg').show();setTimeout(function(){$('#gallery .close').addClass('show');$('#gallery').addClass('show');},200);event.preventDefault();event.stopPropagation();return false;}close(){if(this.container){this.container.remove();$('#bg').hide();}}}class Product extends Buy{constructor(){super();this.id = $('.product')[0].get('data-id');this.activeTab = $('.tabs label.active');$('.tabs label').on('click',this.tabs.bind(this));$('.call-back').on('click', this.callback.bind(this));$('#feedback-form button').on('click',this.feedback.bind(this));$('.quick-order').on('click',this.quickOrder.bind(this));this.gallery = new Gallery(gallery);if(pageObject.compare.includes(this.id))$('#product .fas.fa-balance-scale').active();else{$('#product .fas.fa-balance-scale').on('click',this.comparef.bind(this));}if(pageObject.favorite.includes(this.id))$('#product .fas.fa-star').active();else{$('#product .fas.fa-star').on('click',this.favoritef.bind(this));}this.rating = new Rating();}comparef(event){if(!pageObject.compare.includes(this.id)){pageObject.compare.push(this.id);storage.compare = JSON.stringify(pageObject.compare);}var className = event.target.classList[1];var target = $(`header .${className}`)[0];target.prev().text(pageObject.compare.length);target.parent().show();event.target.active();this.animate(this.getDataAnimateToHeader(target));}favoritef(event){if(!pageObject.favorite.includes(this.id)){pageObject.favorite.push(this.id);storage.favorite = JSON.stringify(pageObject.favorite);}var className = event.target.classList[1];var target = $(`header .${className}`)[0];target.prev().text(pageObject.favorite.length);target.parent().show();event.target.active();this.animate(this.getDataAnimateToHeader(target));}getDataAnimateToHeader(target){var img = $('#big-photo img')[0];var item = $('#big-photo').getBoundingClientRect();return [img,item,target.parent()]}getDataToAnimate(target){var img = $('#big-photo img')[0];var item = $('#big-photo').getBoundingClientRect();var toTarget = $('#cart-button');return [img,item,toTarget]}quickOrder(){try{var qty = $('#product .quantity input')[0].value;}catch(e){var qty = 1;}var that = this;http.action = function(){if(typeof http.json !== 'undefined' && typeof http.json.href !== 'undefined')location.href = http.json.href;else{pageObject.renderForm();}var quickOrder = new Callback(that.id,qty);};http.get(`/checkout/quick_order/${this.id}/${qty}`);ga('send', 'event', 'заказ 1 клик', 'отправить заказ в 1 клик', '');return false;}tabs(event){activeTab.removeClass('active');activeTab = this;this.addClass('active');}callback(){var that = this;http.action = function(){pageObject.renderForm();var callback = new Callback(that.id);};http.get(`/checkout/callback/${this.id}`);}feedback(){http.action = function(){if(http.json && http.json.result){var text = $('#id_text').value;var template = getTemplate($('#feedbackTemplate'));template.querySelector('h4').text(http.json.author);template.querySelector('p').text(text);$('#reviews').before(template);$('#feedback-form').remove();$('#id_text').value = '';}else if(http.json.authenticate){pageObject.user.signinForm();}else{http.alert('Странно','Мы обработали ваш запрос, но ничего не вышло.');}};var data = $('#feedback-form').serializeJSON();data['product'] = this.id;if(data['text'].length < 20)return false;http.post('/catalog/feedback',data);}}class Filter{constructor(parameters){this.q = new URLSearchParams(window.location.search).get('q');this.form = $('#filters');this.min = parseInt(parameters['min']);this.max = parseInt(parameters['max']);this.page = parameters['page'];this.num_pages = parameters['num_pages'];this.slider();this.url = new URL(`${location.protocol}//${location.host}${location.pathname}${location.search}`);this.init();$('#filters .aprove').on('click',this.filter.bind(this));customizeSelect();addEventListener('scroll',this.scrollFilter.bind(this));}init(){this.ordering = this.url.searchParams.get('ordering');if(this.ordering)$('#price-sort').value = this.ordering;this.storage__in = this.url.searchParams.get('storage__in');this.storage__in = eval(this.storage__in);if(this.storage__in){this.storage__in = this.storage__in.join();$('#storage-filter').value = this.storage__in;}this.brand__id__in = this.url.searchParams.get('brand__id__in');this.brand__id__in = eval(this.brand__id__in);if(this.brand__id__in){for(var item of this.brand__id__in){var i = $(`input[name="brand__id__in[]"][value="${item}"]`)[0];if(i){i.checked = true;}}}this.attributes__id = this.url.searchParams.get('attributes__id');this.attributes__id = eval(this.attributes__id);if(this.attributes__id){for(var item of this.attributes__id){$(`.attributes option[value="${item}"]`)[0].parent().value=item;}}if(window.and_filters){for(var item of and_filters){$('option[value="'+item[1]+'"]').parent().val(item[1]);$('option[value="'+item[1]+'"]').parent().selectmenu('refresh');}}}do_filter(scroll){if(!scroll){this.url.search = "";}var parameters = this.form.serializeJSON();if(scroll && this.page)parameters['page'] = this.page;for(var parameter of Object.keys(parameters)){if(typeof parameters[parameter] == 'object')this.url.searchParams.set(parameter,"["+parameters[parameter]+"]");else{this.url.searchParams.set(parameter,parameters[parameter]);}}var that = this;http.action = function(){$('.pagination').remove();if(scroll && that.page){$('#category .items').after(http.responseText);$('.buy').on('click',view.buy.bind(view));$('.quantity .minus').on('click',view.minus.bind(view));$('.quantity .plus').on('click',view.plus.bind(view));$('.quantity input').on('change',view.input.bind(view));that.page++;if(that.page > that.num_pages)that.page = 0;else{that.url.searchParams.set('page',that.page);}}else{$('#category .items').html(http.responseText);}if(!scroll && document.documentElement.clientHeight < 800)scrollTop();};if(this.q)this.url.searchParams.set('q',this.q);var href = this.url.pathname + this.url.search;if(scroll)http.get(href);else{location.href = `${location.protocol}//${location.host}${href}`;}}scrollFilter(event){if(document.body.clientHeight - window.scrollY - window.screen.height > 7000)return;if(!this.page)return;if(!http.progress)this.do_filter(true);event.stopPropagation();return false;}filter(event){if(!http.progress)this.do_filter();event.stopPropagation();return false;}slider(){if(this.min && this.max && (this.min < this.max)){var slider = $('#slider-range');var from = $("#amount-from");var to = $("#amount-to");noUiSlider.create(slider,{start: [this.min, this.max],connect: true,range: {'min':this.min,'max':this.max}});slider.noUiSlider.on('update', function (values, handle) {var value = values[handle];if (handle) {to.value = Math.round(value);} else {from.value = Math.round(value);}});from.addEventListener('change', function () {html5Slider.noUiSlider.set([this.value, null]);});to.addEventListener('change', function () {html5Slider.noUiSlider.set([null, this.value]);});}}}class Category extends Buy{constructor(){super();this.filter = new Filter(window.parameters);this.list();$('#filters label.dropdownButton').on('click',this.showFilter.bind(this));$('#filters .close').on('click',this.closeFilter.bind(this));}showFilter(e){var target = e.target;target.next().next().toggle();target.next().show();$('#bg').toggle();var closeButton = target.next();setTimeout(function(){closeButton.toggleClass('show');},100);}closeFilter(e){var closeButton = e.target;setTimeout(function(){closeButton.toggleClass('show');closeButton.hide();},100);closeButton.next().hide();$('#bg').hide();}list(){if(!storage.list)storage.list = 'grid';$(`#elementStyle i[type="${storage.list}"]`).addClass('active');$('main .items').toggleClass(storage.list);$('#elementStyle i').on('click',function(){var type = this.attr('type');$('main .items').toggleClass(storage.list);$('main .items').toggleClass(type);$('#elementStyle i.active').toggleClass('active');$(`#elementStyle i[type="${type}"]`).toggleClass('active');storage.list = type;});}}class Brand extends Category{constructor(){super();}}class Tag extends Category{constructor(){super();}}class Sale extends Category{constructor(){super();}}class Bestsellers extends Category{constructor(){super();}}class New extends Category{constructor(){super();}}class Checkout{constructor(){this.cart();this.nonPrefixRe = /([0-9]{2,3})([0-9]{3})([0-9]{2})([0-9]{2})/;this.prefixRe = /([0-9]{2})([0-9]{3})([0-9]{3})([0-9]{2})([0-9]{2})/;this.plusPrefixRe = /(\+[0-9]{2})([0-9]{3})([0-9]{3})([0-9]{2})([0-9]{2})/;$('#checkoutForm .remove').on('click',this.remove.bind(this));this.phoneInput = $('#id_phone');$('body').on('click',function(){if($('#departament .variants').css('display') == 'block' && $('#id_departament').value)$('#departament .variants').hide();if($('#city .variants').css('display') && $('#id_city').value)$('#city .variants').hide();});if($('#id_phone').value)this.replacePhone();$('#id_phone').on('change paste', this.replacePhone.bind(this));$('#id_phone').on('keypress', function (event) {var regex = new RegExp("^[a-zA-Z]+$");var key = String.fromCharCode(!event.charCode ? event.which : event.charCode);if (regex.test(key)) {event.preventDefault();return false;}var that = this;if(timeout)clearTimeout(timeout);timeout = setTimeout(function(){that.replacePhone();},1000);}.bind(this));this.delivery = new Delivery();this.form = $('#checkoutForm');$('#checkoutForm button').on('click',this.submit.bind(this));customizeSelect('.custom-select');}cart(){for(var i of Object.keys(cartJson)){pageObject.cart[i] = cartJson[i];}}submit(){this.form.submit();log('submit');log(this.form);}remove(event){var target = event.target.parent();var productId = target.get('product-id');var itemId = target.get('data');if(itemId){http.action = function(){if(http.json){delete pageObject.cart[productId];storage.cart = JSON.stringify(pageObject.cart);storage.qty = parseInt(storage.qty) - 1;pageObject.cartQty.text(storage.qty);if(http.json.total == '0'){$('#checkoutForm').remove();$('h1')[0].text('Ваша корзина пуста.');}else{$('#total #sum').text(http.json.total);if(http.json.discount == 0){$('#discount').parent().remove();}else{$('#discount').text(http.json.discount);}target.parent().remove();}}else{http.alert('Ой!','Что то пошло не так. Приносим извинения.');}};http.get(`/checkout/remove/${itemId}/`);}}replacePhone(){var phoneValue = this.phoneInput.value;if(phoneValue.match(this.nonPrefixRe))this.phoneInput.value = phoneValue.replace(this.nonPrefixRe,'($1)-$2-$3-$4');if(phoneValue.match(this.prefixRe))this.phoneInput.value = phoneValue.replace(this.prefixRe,'+$1-($2)-$3-$4-$5');if(phoneValue.match(this.plusPrefixRe))this.phoneInput.value = phoneValue.replace(this.plusPrefixRe,'$1-($2)-$3-$4-$5');}}class Delivery{constructor(){this.departament = $('#departament');this.city = $('#city');this.messageBox = $('#delivery_message');this.paymentTypeBox = $('#id_payment_type');this.lname = $('#id_lname');this.sname = $('#id_sname');this.paymentOptions = $('#id_payment_type option');this.timeout = NaN;this.npMessage = 'Внимание! Курьерская доставка осуществляется транспортной компанией \Новая Почта согласно их тарифам и по 100%й предоплате. Оплата самой доставки осуществляется \наличными при получении товара, курьеру Новой Почты.';this.prepayMessage = 'Внимание! Доставка возможна только по предоплате.';$('#id_delivery_type').on('change select',this.delivery_type.bind(this));}delivery_type(event){var target = event.target;var val = target.value;this.initials(val);this.paymentType(val);switch(val){case "1": this.delivery(val); break;case "2": this.delivery(val); break;case "3": this.address(); break;case "5": this.address();this.deliveryMessage(this.npMessage); break;default: this.default(); break;}}message(message){this.messageBox.show();$('#id_payment_type option[value="1"]')[0].set('disabled','disabled');}address(){this.departament.clear();this.city.clear();this.city.append(getTemplate($('#addressTemplate')));this.city.show();}deliveryMessage(message){this.paymentTypeBox.value = '2';this.message(message);$('#id_payment_type option[value="1"]')[0].set('disabled','disabled');}initials(val){if(val == 4){this.lname.parent().hide();this.sname.parent().hide();this.lname.required = false;}else{this.lname.parent().show();this.sname.parent().show();this.lname.required = true;}}paymentType(val){if(val == 2 || val == 3){this.paymentTypeBox.value = '2';this.message(this.prepayMessage);}}delivery(val){if(val == 1){this.messageBox.hide();this.paymentTypeBox.value = '';this.paymentOptions.removeAttr('disabled', 'disabled');}var that = this;if(val == 2 || val == 1){this.city.clear();this.departament.clear();this.city.append(getTemplate($('#cityTemplate')));$('#id_city').on('input paste keypress',function(){if(that.timeout)clearTimeout(that.timeout);if($('#city .variants').css('display') == 'block')$('#city .variants').hide();that.timeout = setTimeout(function(){var value = $('#id_city').value;if(value && value.length > 1)that.field = new DeliveryField($('#id_delivery_type').value,'city',$('#id_city').value);},500);});}}default(){this.city.clear();this.departament.clear();this.messageBox.hide();this.paymentOptions.removeAttr('disabled', 'disabled');this.paymentTypeBox.value = '';}}class DeliveryField{constructor(type,path,val,city){this.timeout = NaN;this.type = type;this.path = path;this.val = val;this.city = city;this.load();}load(){if(typeof this.city !== 'undefined')var url = `/checkout/${this.path}/${this.type}/${this.val}/${this.city}`;else{var url = `/checkout/${this.path}/${this.type}/${this.val}`;}var that = this;http.action = function(){that.render();$(`#id_${that.path}`).on('click',function(event){if(that.path == 'city' && view.delivery.departament.css('display') == 'block')view.delivery.departament.hide();if($(`#${that.path} .variants`)[0].children.length)$(`#${that.path} .variants`).show();event.stopPropagation();return false;});$(`#${that.path} .variants .variant`).on('click',that.variants.bind(that));};http.get(url);}variants(event){var target = event.target;$(`#id_${this.path}`).value = target.text();$(`#${this.path} .variants`).hide();$(`input[name="${this.path}"]`)[0].value = target.get('value');if(this.path == 'departament')return;view.delivery.departament.clear();view.delivery.departament.append(getTemplate($('#departamentTemplate')));view.delivery.departament.show();var url = `/checkout/departament/${$('#id_delivery_type').value}/${$('input[name="city"]')[0].value}`;this.reload(url);$('#id_departament').on('input paste keypress',this.input.bind(this));}input(){var that = this;if(this.timeout)clearTimeout(this.timeout);this.timeout = setTimeout(function(){var value = $('#id_departament').value;if(value && value.length > 1){that.departament = new DeliveryField($('#id_delivery_type').value,'departament',$('#id_departament').value,$('input[name="city"]')[0].value);}},500);}render(){$(`#${this.path} .variants`).show();$(`#${this.path} .variants`).clear();$(`#${this.path} .variants`).html(this.template());if(http.json.items.length == 1){var that = this;setTimeout(function(){$(`#${that.path} .variants .variant`)[0].click();},100);}}template(){var result = '';for(var item of http.json.items){result += `<div class="variant" value="${item.id}">${item.address}</div>`;}return result;}reload(url){var that = this;http.action = function(){$('#id_departament').focus();$('#departament .variants').show();$('#departament .variants').clear();$('#departament .variants').html(that.template());$('#departament .variants .variant').on('click',function(){$('#id_departament').value = this.text();$('#departament .variants').hide();$('input[name="departament"]')[0].value = this.get('value');});$('#id_departament').on('click',function(event){if($('#departament .variants')[0].children.length)$('#departament .variants').show();event.stopPropagation();return false;});};http.get(url);}}class QuickOrder{constructor(id,qty){this.id = id;this.qty = qty;try{$("#id_phone")[0].focus();$('#id_phone').on('keypress', this.keypress.bind(this));$('#quickOrderForm').on('submit',this.submit.bind(this));}catch(e){}}keypress(event){var regex = new RegExp("^[a-zA-Z]+$");var key = String.fromCharCode(!event.charCode ? event.which : event.charCode);if (regex.test(key)) {event.preventDefault();return false;}}submit(event){http.action = function(){if(window.http.json && window.http.json.href){location.href = http.json.href;}};http.post(`/checkout/quick_order/${this.id}/${this.qty}`,$('#quickOrderForm').serializeJSON());return false;}}class Callback{constructor(id){this.id = id;try{$('#id_phone').focus();$('#id_phone').on('keypress', this.keypress.bind(this));$('#quickOrderForm').on('submit',this.submit.bind(this));}catch(e){}}keypress(event){var regex = new RegExp("^[a-zA-Z]+$");var key = String.fromCharCode(!event.charCode ? event.which : event.charCode);if (regex.test(key)) {event.preventDefault();return false;}}submit(event){var that = this;var target = event.target;http.action = function(){pageObject.renderForm();try{$('#id_phone').focus();$('#quickOrderForm').on('submit',that.submit.bind(that));}catch(e){}};http.post(`/checkout/callback/${this.id}`,target.serializeJSON());}}class Guestbook{constructor(){$('#leave-review').on('click',this.review);$('#review-form textarea').on('change',function(){if(this.value.length > 20)this.css('border','1px solid grey');});$('.reply').on('click',function(){$('#review-form').show();});}review(){if($('#review-form').css('display') == 'block'){if($('#review-form textarea')[0].value.length > 20){http.action = function(){if(typeof http.json !== 'undefined' && http.json.result){$('#review-form').hide();http.alert('Спасибо за отзыв! Он появится на сайте после модерации.',7000);$('#leave-review').remove();$('#review-form').remove();}else if(http.json && http.json.authenticate){pageObject.user.signinForm();}else{http.alert('Форма не валидна' + http.json.errors);}$('#bg').hide();};http.post('/leave_review',$('#review-form').serializeJSON());}else{$('#review-form textarea').css('border','1px solid red');http.alert('Форма не валидна Минимум 20 сиволов для текста отзыва.');}}else{$('#review-form').show();}}}class Home extends Buy{constructor(){super();this.sliderLength = $('#slider img').length;this.index = 0;this.touchStartPosition;this.sliderTimeout;this.verbose = false;this.container = $('#slider');this.image = $('#slider img')[0];this.touchEndPosition = 0;if($('#slider img').length > 1){this.sliderInverval = setInterval(this.slide.bind(this),2000);this.container.on("touchstart",this.start.bind(this));this.container.on("touchend",this.stop.bind(this));}pageObject.navigation = new Navigation();}start(e){if(this.sliderInverval)clearInterval(this.sliderInverval);if(e.changedTouches)this.touchStartPosition = e.changedTouches[0].clientX;else{this.touchStartPosition = e.clientX;}if(this.verbose)log('touchStartPosition is: ' + this.touchStartPosition);}stop(e){if(this.sliderInverval)clearInterval(this.sliderInverval);if(this.sliderTimeout)clearTimeout(this.sliderTimeout);this.touchEndPosition = e.changedTouches[0].clientX;if(this.verbose)log('touchEndPosition is: ' + this.touchEndPosition);if(this.touchEndPosition < this.touchStartPosition)this.index++;else if(this.touchEndPosition > this.touchStartPosition)this.index--;this.slide(true);var that = this;this.sliderTimeout = setTimeout(function(){that.sliderInverval = setInterval(that.slide.bind(that),2000);},2000);e.preventDefault();e.stopPropagation();return false;}slide(touch){if(!touch && this.sliderInverval)this.index++;if(this.index >= this.sliderLength){if(!touch && this.sliderInverval)this.index = 0;else if(touch && !this.sliderInverval){this.index = this.sliderLength;return;}}if(this.index < 0){this.index = 0;return;}if(this.verbose)log('index is: ' + this.index);this.image.css('margin-left',this.index * -100 + '%');}}class Main extends Home{constructor(){super();}}class Profile{constructor(){this.button = $('#change-order');$('#orderForm').each(function(elem){this.change(elem)}.bind(this));}change(elem){elem.on('change input paste',function(){this.button.removeAttr('disabled');this.button.addClass('blue');}.bind(this));}}class User{constructor(){$('#sign-in, .sign-in, #login-button').on('click', this.signinForm.bind(this));$('#sign-out').on('click',this.logout.bind(this));var that = this;}signupForm(){this.signup = new Signup();}logout(){http.action = function(){if(window.http.json && window.http.json.result == 1)location.reload();};http.get('/user/signout/');}signinForm(){var that = this;http.action = function(){if(http.json && http.json.result)location.reload();pageObject.renderForm();$('#signin').on('submit',that.login.bind(that));$('#forget').on('click',that.forget_password.bind(that));$('#sign-up').on('click',that.signupForm.bind(that));};http.get('/user/signin/');return false;}login(){var that = this;http.action = function(){if(http.json && http.json.result)location.reload();else if(http.json){social();}else{pageObject.renderForm();$('#signin').on('submit',that.login.bind(that));$('#forget').on('click',that.forget_password.bind(that));}};http.post('/user/signin/',$('#signin').serializeJSON());}forget_password(){$('#forget-password-form').show();$('#forget-password-form button').on('click',function(){http.action = function(){};http.post('/user/forget-password/',$('#forget-password-form').serializeJSON());});}}class Signup{constructor(){this.loadForm();}submit(){http.action = function(){if(http.json && http.json.href){$('#form').hide();$('#bg').hide();location.href = http.json.href;}};http.post('/user/signup/',$('#signup').serializeJSON());return false;}loadForm(){var that = this;http.action = function(){pageObject.renderForm();$('#signup').on('submit',that.submit);$('#id_phone').on('keypress', function (event) {var regex = new RegExp("^[a-zA-Z]+$");var key = String.fromCharCode(!event.charCode ? event.which : event.charCode);if (regex.test(key)) {event.preventDefault();return false;}});};http.get('/user/signup/');}}class Signin{constructor(){$('#signin').on('submit',this.login.bind(this));$('#forget').on('click',this.forget_password.bind(this));$('#sign-up').on('click',this.signup);}login(){var that = this;http.action = function(){if(http.json && http.json.result)location.reload();else if(http.json){social();}};http.post('/user/signin/',$('#signin').serializeJSON());}forget_password(){$('#forget-password-form').show();$('#forget-password-form button').on('click',function(){http.action = function(){};http.post('/user/forget-password/',$('#forget-password-form').serializeJSON());});}signup(){this.signup = new Signup();}}class Compare{constructor(){}}class Favorite{constructor(){document.ready(this.ready.bind(this));}ready(){http.action = function(){$('#content').html(http.response);};http.get('/user/favorite/');}}class Navigation{constructor(){this.touchStartPositionX;this.touchStartPositionY;this.verbose = false;this.touchEndPositionX = 0;this.touchEndPositionY = 0;this.active = false;$('#navigation_toggle').on('click',function(){$('#navigation').active();});$('#navigation #navCategories > div,#navigation .children > div,#navigation .sub > .parent,#navigation .image').on('click',this.sub.bind(this));$('#navigation').on('touchstart',this.touchStart.bind(this));$('#navigation').on('touchend',this.touchEnd.bind(this));}static scroll(){window.scrollTo({top:$('#navigation .head')[0].offsetTop - 58,behavior: 'smooth'});}static toggle(){if($('#categories-container').children.length){if(window.scrollY > $('#navigation').height() || $('#categories-container').style.display == 'none'){Navigation.scroll();$('#categories-container').show();}else{$('#categories-container').hide();}}else{var that = this;http.action = function(){$('#categories-container').html(http.response);$('#categories-container').show();$('main .container > .loading').active();that.active = true;Navigation.scroll();pageObject.navigation = new Navigation();};$('main > .container > .loading').active();http.get('/categories');}}touchStart(e){if(e.changedTouches){this.touchStartPositionX = e.changedTouches[0].clientX;this.touchStartPositionY = e.changedTouches[0].clientY;}else{this.touchStartPositionX = e.clientX;this.touchStartPositionY = e.clientY;}if(this.verbose){log('touchStartPositionX is: ' + this.touchStartPositionX);log('touchStartPositionY is: ' + this.touchStartPositionY);}}touchEnd(e){this.touchEndPositionX = e.changedTouches[0].clientX;this.touchEndPositionY = e.changedTouches[0].clientY;if(this.verbose){log('touchEndPositionX is: ' + this.touchEndPositionX);log('touchEndPositionY is: ' + this.touchEndPositionY);}var diffX = this.touchEndPositionX - this.touchStartPositionX;var diffY = this.touchEndPositionY - this.touchStartPositionY;if(this.touchEndPositionX != this.touchStartPositionX && diffX > 100 && diffY < 50){this.back();}}back(){var last = $('#navigation .sub.active').last();last.removeClass('active');last.prev().removeClass('active');this.changeHeight();}changeHeight(){var last = $('#navigation .sub.active').last();if(!last)return;var h = last.height();$('#navigation #navCategories')[0].css('height',h + 'px');}sub(event){if(event.target.hasClass('image')){event.target.parent().click();event.stopPropagation();event.preventDefault();return false;}if(event.target.find('.sub').length && event.target.find('.sub')[0].hasClass('active'))return false;var sub = event.target.find('.sub');if(sub.length){$('.nav-bg.active').removeClass('active');setTimeout(function(){event.target.find('.nav-bg')[0].active();},300);}if(sub.length)sub[0].active();else{var a = event.target.find('a');if(a.length)a[0].click();}if(sub.length){this.changeHeight();}}}